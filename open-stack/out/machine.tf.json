{
  "resource": {
    "openstack_blockstorage_volume_v2": {
      "lab_volume_lab_machine_pfsenseWAN": {
        "name": "lab_volume_lab_machine_pfsenseWAN",
        "image_id": "${data.openstack_images_image_v2.pfsense.id}",
        "size": 30
      },
      "lab_volume_lab_machine_identity": {
        "name": "lab_volume_lab_machine_identity",
        "image_id": "${data.openstack_images_image_v2.debian10.id}",
        "size": 20
      },
      "lab_volume_lab_machine_central_log": {
        "name": "lab_volume_lab_machine_central_log",
        "image_id": "${data.openstack_images_image_v2.debian10.id}",
        "size": 20
      }
    },
    "openstack_compute_flavor_v2": {
      "lab_flavor_lab_machine_pfsenseWAN": {
        "name": "lab_flavor_lab_machine_pfsenseWAN",
        "disk": 30,
        "ram": 4096,
        "vcpus": 2
      },
      "lab_flavor_lab_machine_identity": {
        "name": "lab_flavor_lab_machine_identity",
        "disk": 20,
        "ram": 8192,
        "vcpus": 4
      },
      "lab_flavor_lab_machine_central_log": {
        "name": "lab_flavor_lab_machine_central_log",
        "disk": 20,
        "ram": 8192,
        "vcpus": 4
      }
    },
    "openstack_compute_instance_v2": {
      "lab_machine_pfsenseWAN": {
        "name": "lab_machine_pfsenseWAN",
        "block_device": [
          {
            "uuid": "${openstack_blockstorage_volume_v2.lab_volume_lab_machine_pfsenseWAN.id}",
            "source_type": "volume",
            "boot_index": 0,
            "destination_type": "volume",
            "delete_on_termination": true
          }
        ],
        "flavor_id": "${openstack_compute_flavor_v2.lab_flavor_lab_machine_pfsenseWAN.id}",
        "network": [
          {
            "uuid": "${data.openstack_networking_network_v2.public_net.id}",
            "port": "${openstack_networking_port_v2.lab_port_ip19216800.id}"
          },
          {
            "uuid": "${openstack_networking_network_v2.lab_network_conf_net.id}",
            "port": "${openstack_networking_port_v2.lab_port_ip1721610100.id}"
          },
          {
            "uuid": "${openstack_networking_network_v2.lab_network_service_net.id}",
            "port": "${openstack_networking_port_v2.lab_port_ip172161001.id}"
          },
          {
            "uuid": "${openstack_networking_network_v2.lab_network_identity_net.id}",
            "port": "${openstack_networking_port_v2.lab_port_ip172161101.id}"
          }
        ]
      },
      "lab_machine_identity": {
        "name": "lab_machine_identity",
        "block_device": [
          {
            "uuid": "${openstack_blockstorage_volume_v2.lab_volume_lab_machine_identity.id}",
            "source_type": "volume",
            "boot_index": 0,
            "destination_type": "volume",
            "delete_on_termination": true
          }
        ],
        "flavor_id": "${openstack_compute_flavor_v2.lab_flavor_lab_machine_identity.id}",
        "network": [
          {
            "uuid": "${openstack_networking_network_v2.lab_network_conf_net.id}",
            "port": "${openstack_networking_port_v2.lab_port_ip1721610110.id}"
          },
          {
            "uuid": "${openstack_networking_network_v2.lab_network_service_net.id}",
            "port": "${openstack_networking_port_v2.lab_port_ip1721610010.id}"
          }
        ],
        "user_data": "${file(\"../cloud-init/ubuntu_cloud_init.yml\")}",
        "config_drive": true
      },
      "lab_machine_central_log": {
        "name": "lab_machine_central_log",
        "block_device": [
          {
            "uuid": "${openstack_blockstorage_volume_v2.lab_volume_lab_machine_central_log.id}",
            "source_type": "volume",
            "boot_index": 0,
            "destination_type": "volume",
            "delete_on_termination": true
          }
        ],
        "flavor_id": "${openstack_compute_flavor_v2.lab_flavor_lab_machine_central_log.id}",
        "network": [
          {
            "uuid": "${openstack_networking_network_v2.lab_network_conf_net.id}",
            "port": "${openstack_networking_port_v2.lab_port_ip1721610120.id}"
          },
          {
            "uuid": "${openstack_networking_network_v2.lab_network_identity_net.id}",
            "port": "${openstack_networking_port_v2.lab_port_ip1721611010.id}"
          }
        ],
        "user_data": "${file(\"../cloud-init/ubuntu_cloud_init.yml\")}",
        "config_drive": true
      }
    },
    "openstack_networking_port_v2": {
      "lab_port_ip19216800": {
        "network_id": "${data.openstack_networking_network_v2.public_net.id}",
        "fixed_ip": {
          "subnet_id": "${data.openstack_networking_subnet_v2.public_subnet.id}",
          "ip_address": "192.168.0.0"
        },
        "port_security_enabled": false
      },
      "lab_port_ip1721610100": {
        "network_id": "${openstack_networking_network_v2.lab_network_conf_net.id}",
        "fixed_ip": {
          "subnet_id": "${openstack_networking_subnet_v2.lab_subnet_conf_net.id}",
          "ip_address": "172.16.10.100"
        },
        "port_security_enabled": false
      },
      "lab_port_ip172161001": {
        "network_id": "${openstack_networking_network_v2.lab_network_service_net.id}",
        "fixed_ip": {
          "subnet_id": "${openstack_networking_subnet_v2.lab_subnet_service_net.id}",
          "ip_address": "172.16.100.1"
        },
        "port_security_enabled": false
      },
      "lab_port_ip172161101": {
        "network_id": "${openstack_networking_network_v2.lab_network_identity_net.id}",
        "fixed_ip": {
          "subnet_id": "${openstack_networking_subnet_v2.lab_subnet_identity_net.id}",
          "ip_address": "172.16.110.1"
        },
        "port_security_enabled": false
      },
      "lab_port_ip1721610110": {
        "network_id": "${openstack_networking_network_v2.lab_network_conf_net.id}",
        "fixed_ip": {
          "subnet_id": "${openstack_networking_subnet_v2.lab_subnet_conf_net.id}",
          "ip_address": "172.16.10.110"
        },
        "port_security_enabled": false
      },
      "lab_port_ip1721610010": {
        "network_id": "${openstack_networking_network_v2.lab_network_service_net.id}",
        "fixed_ip": {
          "subnet_id": "${openstack_networking_subnet_v2.lab_subnet_service_net.id}",
          "ip_address": "172.16.100.10"
        },
        "port_security_enabled": false
      },
      "lab_port_ip1721610120": {
        "network_id": "${openstack_networking_network_v2.lab_network_conf_net.id}",
        "fixed_ip": {
          "subnet_id": "${openstack_networking_subnet_v2.lab_subnet_conf_net.id}",
          "ip_address": "172.16.10.120"
        },
        "port_security_enabled": false
      },
      "lab_port_ip1721611010": {
        "network_id": "${openstack_networking_network_v2.lab_network_identity_net.id}",
        "fixed_ip": {
          "subnet_id": "${openstack_networking_subnet_v2.lab_subnet_identity_net.id}",
          "ip_address": "172.16.110.10"
        },
        "port_security_enabled": false
      }
    }
  }
}